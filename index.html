<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Revive with Sade Massage - Book Your Session</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<style>
    /* --- Keep all your existing styles exactly the same --- */
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1 class="logo">Revive with Sade</h1>
        <p class="tagline">Premium Massage Therapy & Wellness</p>
    </div>
    <form class="booking-form" id="bookingForm" action="https://formspree.io/f/xldpgneq" method="POST">
        <input type="hidden" name="_next" value="thank-you.html">
        <input type="hidden" name="_subject" value="New Massage Booking Request">
        <input type="hidden" name="_captcha" value="false">

        <!-- Personal Information -->
        <div class="form-section">
            <h2 class="section-title">Personal Information</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="firstName">First Name *</label>
                    <input type="text" id="firstName" name="firstName" required>
                </div>
                <div class="form-group">
                    <label for="lastName">Last Name *</label>
                    <input type="text" id="lastName" name="lastName" required>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="phone">Phone Number *</label>
                    <input type="tel" id="phone" name="phone" required>
                </div>
                <div class="form-group">
                    <label for="email">Email Address *</label>
                    <input type="email" id="email" name="email" required>
                </div>
            </div>
        </div>

        <!-- Location Selection -->
        <div class="form-section">
            <h2 class="section-title">Location Preference</h2>
            <div class="form-group full-width">
                <label for="locationType">Where would you like your massage? *</label>
                <select id="locationType" name="locationType" required>
                    <option value="">Select Location Type</option>
                    <option value="destination">At Our Studio (Base Price)</option>
                    <option value="address">At Your Address (Mobile Service)</option>
                </select>
            </div>
            <div class="address-dropdown" id="addressSection">
                <div class="form-group full-width">
                    <label for="clientAddress">Your Address *</label>
                    <textarea id="clientAddress" name="clientAddress" rows="3" placeholder="Please enter your full address"></textarea>
                </div>
            </div>
        </div>

        <!-- Service Selection -->
        <div class="form-section">
            <h2 class="section-title">Choose Your Service</h2>
            <div class="service-options">
                <div class="service-card" data-service="30min" data-price="500">
                    <div class="service-title">Relaxation Session</div>
                    <div class="service-duration">30 Minutes</div>
                    <div class="service-price">500 Le</div>
                </div>
                <div class="service-card" data-service="60min" data-price="1000">
                    <div class="service-title">Full Body Massage</div>
                    <div class="service-duration">60 Minutes</div>
                    <div class="service-price">1,000 Le</div>
                </div>
            </div>
            <input type="hidden" id="selectedService" name="selectedService" required>
            <input type="hidden" id="servicePrice" name="servicePrice" required>
        </div>

        <!-- Date and Time Selection -->
        <div class="form-section">
            <h2 class="section-title">Select Date & Time</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="bookingDate">Preferred Date *</label>
                    <input type="text" id="bookingDate" name="bookingDate" placeholder="Select date" required>
                </div>
                <div class="form-group">
                    <label for="bookingTime">Preferred Time *</label>
                    <select id="bookingTime" name="bookingTime" required>
                        <option value="">Select Time</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Additional Information -->
        <div class="form-section">
            <h2 class="section-title">Additional Information</h2>
            <div class="form-group full-width">
                <label for="specialRequests">Special Requests or Health Considerations</label>
                <textarea id="specialRequests" name="specialRequests" rows="4" placeholder="Please let us know about any allergies, injuries, or special preferences..."></textarea>
            </div>
        </div>

        <!-- Price Display -->
        <div class="price-display" id="priceDisplay" style="display: none;">
            Total: <span id="totalPrice">0</span> Le
        </div>

        <input type="hidden" id="finalPrice" name="finalPrice">

        <!-- Submit Button -->
        <button type="submit" class="submit-btn" id="submitBtn">Book Your Session</button>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script>
let selectedService = null;
let selectedPrice = 0;
let selectedDuration = 0; // in minutes

// Example booked slots: date => array of booked times
let bookedSlots = {
    "2025-11-12": ["11:00"], // Example booked slot
};

document.addEventListener('DOMContentLoaded', function() {
    flatpickr("#bookingDate", {
        minDate: "today",
        maxDate: "2026-12-31",
        dateFormat: "Y-m-d",
        disable: [date => date.getDay() === 0], // Disable Sundays
        onChange: populateTimeSlots
    });

    document.querySelectorAll('.service-card').forEach(card => {
        card.addEventListener('click', function() {
            document.querySelectorAll('.service-card').forEach(c => c.classList.remove('selected'));
            this.classList.add('selected');
            selectedService = this.dataset.service;
            selectedPrice = parseInt(this.dataset.price);
            selectedDuration = selectedService === '30min' ? 30 : 60;
            document.getElementById('selectedService').value = selectedService;
            document.getElementById('servicePrice').value = selectedPrice;
            updatePricing();
            populateTimeSlots();
        });
    });

    document.getElementById('locationType').addEventListener('change', function() {
        const addressSection = document.getElementById('addressSection');
        if (this.value === 'address') {
            addressSection.classList.add('show');
            document.getElementById('clientAddress').required = true;
        } else {
            addressSection.classList.remove('show');
            document.getElementById('clientAddress').required = false;
        }
        updatePricing();
    });
});

function updatePricing() {
    let locationMultiplier = document.getElementById('locationType').value === 'address' ? 1.2 : 1;
    let total = selectedPrice * locationMultiplier;
    document.getElementById('priceDisplay').style.display = total ? 'block' : 'none';
    document.getElementById('totalPrice').textContent = total.toFixed(0);
    document.getElementById('finalPrice').value = total.toFixed(0);
}

function populateTimeSlots() {
    const timeSelect = document.getElementById('bookingTime');
    const currentValue = timeSelect.value;
    timeSelect.innerHTML = '<option value="">Select Time</option>';

    const startHour = 11;
    const endHour = 18;
    const times = [];
    for (let hour = startHour; hour <= endHour; hour++) {
        times.push(`${hour.toString().padStart(2,'0')}:00`);
        times.push(`${hour.toString().padStart(2,'0')}:30`);
    }

    const selectedDate = document.getElementById('bookingDate').value;

    times.forEach((time, index) => {
        let option = document.createElement('option');
        option.value = time;
        option.textContent = time;

        let disabled = false;

        // Disable if already booked
        if (selectedDate && bookedSlots[selectedDate]) {
            if (bookedSlots[selectedDate].includes(time)) {
                disabled = true;
            }
            // If a 60-min session is booked, block next 30-min slot
            if (selectedDuration === 60 && bookedSlots[selectedDate].includes(time)) {
                const prevTime = times[index - 1];
                if (prevTime && bookedSlots[selectedDate].includes(prevTime)) disabled = true;
            }
        }

        if (disabled) {
            option.disabled = true;
            option.textContent += " (Unavailable)";
            option.style.color = "#888";
        }

        timeSelect.appendChild(option);
    });
}
</script>
</body>
</html>
